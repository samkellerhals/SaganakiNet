# SaganakiNet

A transfer-learning ensemble of 9 convolutional neural networks with varying architectures (skip connections & squeeze excitation), trained using Nvidia `V100` and `K80` GPUs to predict class labels of 80 different food types with 69.5% accuracy.

## Getting started

- Create a virtual environment, and install packages using `requirements.txt`

- Run `data.sh` to download a dataset of food images, that was preprocessed using `dataformatter.py`

- All models are located in the `/models` folder. Excecute a file to train the respective model on a GPU. Alternatively, download pretrained models using the following links: [Link1](https://we.tl/t-vQdqJpJoN2), [Link2](https://we.tl/t-mAXv224M9U). Once downloaded put all models into a directory named `bin` at the root of this repository.

- The final predictions CSV is generated by executing `ensemble.py`. Inside the `helpers.py` file you can specify two parameters `PROCESSOR` and `PREDICT_ROWS`. Set this to `gpu` and `7653` if making predictions on the entire dataset of images. 

## models

- `vgg16`
- `xception`
- `vgg19`
- `inceptionv4`
- `inceptionResNet`
- `resnet152_x2`
- `se_resnext50`
- `resnet152_x3`
- `se_resnext101`

## Directory structure

**`data.sh`**

Shell script to download preprocessed dataset from Kaggle.

**`ensemble.py`**

Builds ensemble model of 9 convolutional neural networks, choosing class with highest certainty (probability).

**`helpers.py`**

Helper functions to do model predictions. Also contains two paramaters that you can set that control what processor is used (GPU of CPU) and how many images to make predictions on. Some functions like `process_image() predict()` have been adapted from [LeanManager](https://github.com/LeanManager/PyTorch_Image_Classifier).

**`dataformatter.py`**

Utility script that creates a folder for each class as required by PyTorch.

**`/models`**

Contains code to train each individual model, as well as the respective hyperparameters. Some functions like `validation() & train_classifier()` have been adapted from [LeanManager](https://github.com/LeanManager/PyTorch_Image_Classifier). Source code for models implemented in PyTorch are from [Cadene](https://github.com/Cadene/pretrained-models.pytorch)

**`requirements.txt`**

Contains all libraries used for this project. Create a virtual env and download all modules using `python3 -m venv env; source env/bin/activate; pip install -r requirements`

## Sources
[Cadene GitHub Repository](https://github.com/Cadene/pretrained-models.pytorch)

[LeanManager GitHub Repository](https://github.com/LeanManager/PyTorch_Image_Classifier)

